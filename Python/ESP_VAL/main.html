<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Assistant Pro</title>
    <style>
        /* –°–ë–†–û–° –ò –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: transparent !important;
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'Segoe UI', sans-serif;
        }
        
        /* –û–°–ù–û–í–ù–û–ô OVERLAY –ö–û–ù–¢–ï–ô–ù–ï–† */
        #gameOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none; /* –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∫–ª–∏–∫–∏ —Å–∫–≤–æ–∑—å overlay */
            z-index: 2147483647; /* –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π z-index */
        }
        
        /* –†–ê–î–ê–† –í –£–ì–õ–£ */
        #radarContainer {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 200px;
            height: 200px;
            pointer-events: auto; /* –†–∞–∑—Ä–µ—à–∞–µ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Ä–∞–¥–∞—Ä–æ–º */
        }
        
        #radar {
            width: 100%;
            height: 100%;
            background: radial-gradient(
                circle,
                rgba(10, 15, 30, 0.9) 0%,
                rgba(5, 10, 20, 0.95) 70%,
                rgba(0, 0, 0, 0.98) 100%
            );
            border: 2px solid rgba(0, 175, 255, 0.8);
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 175, 255, 0.5);
            backdrop-filter: blur(5px);
        }
        
        /* –°–ö–ê–ù–ò–†–£–Æ–©–ê–Ø –õ–ò–ù–ò–Ø */
        .sweepLine {
            position: absolute;
            width: 100%;
            height: 100%;
            background: conic-gradient(
                transparent 0deg,
                transparent 180deg,
                rgba(0, 255, 100, 0.3) 181deg,
                rgba(0, 255, 100, 0.6) 270deg,
                transparent 271deg
            );
            animation: sweep 2.5s linear infinite;
            border-radius: 50%;
        }
        
        @keyframes sweep {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* –°–ï–¢–ö–ê –†–ê–î–ê–†–ê */
        .radarGrid {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at center, transparent 65%, rgba(0, 175, 255, 0.1) 65%, rgba(0, 175, 255, 0.1) 70%, transparent 70%),
                radial-gradient(circle at center, transparent 80%, rgba(0, 175, 255, 0.1) 80%, rgba(0, 175, 255, 0.1) 85%, transparent 85%),
                linear-gradient(0deg, transparent 49.5%, rgba(0, 175, 255, 0.2) 50%, transparent 50.5%),
                linear-gradient(90deg, transparent 49.5%, rgba(0, 175, 255, 0.2) 50%, transparent 50.5%),
                linear-gradient(45deg, transparent 49.5%, rgba(0, 175, 255, 0.1) 50%, transparent 50.5%),
                linear-gradient(135deg, transparent 49.5%, rgba(0, 175, 255, 0.1) 50%, transparent 50.5%);
        }
        
        /* –¢–û–ß–ö–ò –í–†–ê–ì–û–í –ù–ê –†–ê–î–ê–†–ï */
        .radarEnemy {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ff3333;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 
                0 0 10px #ff3333,
                0 0 20px #ff3333,
                0 0 30px #ff3333;
            z-index: 10;
            animation: enemyPulse 1.5s ease-in-out infinite;
            border: 2px solid white;
        }
        
        @keyframes enemyPulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.9; }
            50% { transform: translate(-50%, -50%) scale(1.3); opacity: 1; }
        }
        
        /* –õ–ò–ù–ò–ò –ö –í–†–ê–ì–ê–ú –ù–ê –†–ê–î–ê–†–ï */
        .radarLine {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(255, 50, 50, 0.7));
            transform-origin: 0 0;
            z-index: 5;
        }
        
        /* –ò–ù–§–û –û –í–†–ê–ì–ï –ù–ê –†–ê–î–ê–†–ï */
        .enemyInfo {
            position: absolute;
            color: white;
            font-size: 10px;
            background: rgba(255, 50, 50, 0.7);
            padding: 2px 6px;
            border-radius: 3px;
            white-space: nowrap;
            transform: translateX(-50%);
            z-index: 15;
            pointer-events: auto;
        }
        
        /* –û–ë–í–û–î–ö–ê –í–†–ê–ì–û–í –ù–ê –≠–ö–†–ê–ù–ï */
        .enemyOutline {
            position: absolute;
            pointer-events: none;
            z-index: 2147483646;
            box-sizing: border-box;
        }
        
        /* –°–¢–ò–õ–ò –û–ë–í–û–î–ö–ò */
        .outline-box {
            position: absolute;
            border: 3px solid;
            border-radius: 4px;
            animation: outlinePulse 2s infinite;
            box-shadow: 
                0 0 15px currentColor,
                inset 0 0 15px rgba(255, 255, 255, 0.2);
            background: transparent;
        }
        
        .outline-red {
            border-color: #ff3333;
            color: #ff3333;
        }
        
        .outline-orange {
            border-color: #ff9900;
            color: #ff9900;
        }
        
        .outline-yellow {
            border-color: #ffff00;
            color: #ffff00;
        }
        
        @keyframes outlinePulse {
            0%, 100% { 
                box-shadow: 
                    0 0 15px currentColor,
                    inset 0 0 15px rgba(255, 255, 255, 0.2);
            }
            50% { 
                box-shadow: 
                    0 0 25px currentColor,
                    inset 0 0 25px rgba(255, 255, 255, 0.3);
            }
        }
        
        /* –ò–ù–§–û –ù–ê–î –í–†–ê–ì–û–ú */
        .enemyLabel {
            position: absolute;
            color: white;
            font-size: 12px;
            font-weight: bold;
            text-shadow: 
                0 0 5px #000,
                0 0 10px #000;
            padding: 2px 8px;
            border-radius: 3px;
            transform: translateX(-50%);
            white-space: nowrap;
            z-index: 2147483647;
            pointer-events: none;
        }
        
        .label-red {
            background: linear-gradient(135deg, rgba(255, 50, 50, 0.9), rgba(200, 0, 0, 0.9));
            border: 1px solid #ff3333;
        }
        
        .label-distance {
            position: absolute;
            font-size: 10px;
            color: #66ff66;
            text-shadow: 0 0 5px #000;
            transform: translateX(-50%);
            z-index: 2147483647;
        }
        
        /* –ü–ê–ù–ï–õ–¨ –£–ü–†–ê–í–õ–ï–ù–ò–Ø */
        #controlPanel {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(10, 15, 30, 0.85);
            border: 2px solid rgba(0, 175, 255, 0.7);
            border-radius: 10px;
            padding: 15px;
            width: 280px;
            pointer-events: auto;
            backdrop-filter: blur(10px);
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.5);
            z-index: 2147483647;
        }
        
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(0, 175, 255, 0.3);
        }
        
        .panel-title {
            color: #00ff9d;
            font-size: 16px;
            font-weight: bold;
        }
        
        .close-btn {
            background: #ff3333;
            color: white;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 14px;
            line-height: 1;
        }
        
        .config-group {
            margin-bottom: 15px;
        }
        
        .config-label {
            display: block;
            color: #66ccff;
            font-size: 12px;
            margin-bottom: 5px;
        }
        
        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        input[type="range"] {
            flex: 1;
            height: 6px;
            -webkit-appearance: none;
            background: rgba(0, 100, 200, 0.5);
            border-radius: 3px;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: #00a8ff;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px #00a8ff;
        }
        
        .value-display {
            color: #00ff9d;
            font-size: 12px;
            min-width: 30px;
            text-align: right;
            font-family: 'Consolas', monospace;
        }
        
        .color-preview {
            width: 30px;
            height: 30px;
            border-radius: 5px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
        }
        
        .btn {
            background: linear-gradient(135deg, #00a8ff, #0097e6);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            margin: 2px;
            transition: all 0.3s;
        }
        
        .btn:hover {
            background: linear-gradient(135deg, #0097e6, #0088cc);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 168, 255, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ff3838, #e84118);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #00b894, #00a085);
        }
        
        .button-group {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        
        /* –°–¢–ê–¢–£–° –ë–ê–† */
        #statusBar {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: #00ff9d;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 12px;
            pointer-events: auto;
            z-index: 2147483647;
            border: 1px solid #00a8ff;
            backdrop-filter: blur(5px);
        }
        
        /* –ö–†–ï–°–¢–ò–ö –ü–†–ò–¶–ï–õ–ê */
        #crosshair {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 24px;
            height: 24px;
            pointer-events: none;
            z-index: 2147483646;
        }
        
        .crosshair-dot {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 4px;
            height: 4px;
            background: #00ff9d;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 10px #00ff9d;
        }
        
        .crosshair-line {
            position: absolute;
            background: #00ff9d;
            box-shadow: 0 0 5px #00ff9d;
        }
        
        .crosshair-h {
            width: 16px;
            height: 2px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        
        .crosshair-v {
            width: 2px;
            height: 16px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        
        /* –ê–ù–ò–ú–ê–¶–ò–Ø –û–ë–ù–ê–†–£–ñ–ï–ù–ò–Ø */
        .detection-flash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 50, 50, 0.1);
            pointer-events: none;
            z-index: 2147483645;
            animation: flash 0.5s ease-out;
        }
        
        @keyframes flash {
            0% { opacity: 0; }
            50% { opacity: 1; }
            100% { opacity: 0; }
        }
        
        /* –°–ö–†–´–¢–´–ï –≠–õ–ï–ú–ï–ù–¢–´ */
        .hidden {
            display: none !important;
        }
        
        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
        @media (max-height: 800px) {
            #radarContainer {
                width: 150px;
                height: 150px;
                top: 10px;
                right: 10px;
            }
            
            #controlPanel {
                width: 250px;
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- –û–°–ù–û–í–ù–û–ô OVERLAY -->
    <div id="gameOverlay">
        <!-- –†–ê–î–ê–† -->
        <div id="radarContainer">
            <div id="radar">
                <div class="radarGrid"></div>
                <div class="sweepLine"></div>
                <!-- –í—Ä–∞–≥–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
        
        <!-- –ü–ê–ù–ï–õ–¨ –£–ü–†–ê–í–õ–ï–ù–ò–Ø -->
        <div id="controlPanel">
            <div class="panel-header">
                <div class="panel-title">üéÆ Game Assistant Pro</div>
                <button class="close-btn" onclick="togglePanel()">√ó</button>
            </div>
            
            <div class="config-group">
                <label class="config-label">üî¥ Enemy Color:</label>
                <div class="slider-container">
                    <input type="color" id="colorPicker" value="#ff0000" style="flex: 1; height: 30px;">
                    <div class="color-preview" id="colorPreview" style="background: #ff0000;"></div>
                </div>
            </div>
            
            <div class="config-group">
                <label class="config-label">üéØ Detection Sensitivity:</label>
                <div class="slider-container">
                    <input type="range" id="sensitivity" min="1" max="100" value="50">
                    <div class="value-display" id="sensValue">50</div>
                </div>
            </div>
            
            <div class="config-group">
                <label class="config-label">üìè Outline Thickness:</label>
                <div class="slider-container">
                    <input type="range" id="outlineWidth" min="1" max="10" value="3">
                    <div class="value-display" id="outlineValue">3px</div>
                </div>
            </div>
            
            <div class="config-group">
                <label class="config-label">üåà Outline Color:</label>
                <div style="display: flex; gap: 10px; margin-top: 5px;">
                    <button class="btn" onclick="setOutlineColor('red')" style="background: #ff3333;">Red</button>
                    <button class="btn" onclick="setOutlineColor('orange')" style="background: #ff9900;">Orange</button>
                    <button class="btn" onclick="setOutlineColor('yellow')" style="background: #ffff00; color: #000;">Yellow</button>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-success" onclick="startCapture()">üñ•Ô∏è Start Capture</button>
                <button class="btn" onclick="calibrateColor()">üé® Calibrate Color</button>
                <button class="btn" onclick="toggleRadar()">üì° Toggle Radar</button>
                <button class="btn" onclick="toggleOutlines()">üî≤ Toggle Outlines</button>
                <button class="btn btn-danger" onclick="resetAll()">üîÑ Reset All</button>
            </div>
        </div>
        
        <!-- –°–¢–ê–¢–£–° –ë–ê–† -->
        <div id="statusBar">
            ‚è≥ Ready - Press Ctrl+Shift+S to start capture
        </div>
        
        <!-- –ö–†–ï–°–¢–ò–ö –ü–†–ò–¶–ï–õ–ê -->
        <div id="crosshair">
            <div class="crosshair-dot"></div>
            <div class="crosshair-line crosshair-h"></div>
            <div class="crosshair-line crosshair-v"></div>
        </div>
        
        <!-- –û–±–≤–æ–¥–∫–∏ –≤—Ä–∞–≥–æ–≤ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
    </div>

    <script>
        // === –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –°–ò–°–¢–ï–ú–´ ===
        const CONFIG = {
            // –¶–≤–µ—Ç –≤—Ä–∞–≥–∞
            enemyColor: { r: 255, g: 0, b: 0 },
            colorThreshold: 40,
            
            // –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
            sensitivity: 50,
            scanStep: 10, // –®–∞–≥ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–º–µ–Ω—å—à–µ = —Ç–æ—á–Ω–µ–µ, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ)
            
            // –û–±–≤–æ–¥–∫–∞
            outlineEnabled: true,
            outlineWidth: 3,
            outlineColor: 'red', // red, orange, yellow
            outlineColors: {
                red: '#ff3333',
                orange: '#ff9900',
                yellow: '#ffff00'
            },
            
            // –†–∞–¥–∞—Ä
            radarEnabled: true,
            radarSize: 200,
            showDistance: true,
            
            // –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
            updateInterval: 100, // –º—Å
            maxEnemies: 10
        };
        
        // === –°–û–°–¢–û–Ø–ù–ò–ï –°–ò–°–¢–ï–ú–´ ===
        const STATE = {
            // –ó–∞—Ö–≤–∞—Ç —ç–∫—Ä–∞–Ω–∞
            isCapturing: false,
            screenStream: null,
            videoElement: null,
            canvas: null,
            ctx: null,
            
            // –í—Ä–∞–≥–∏
            enemies: [],
            enemyOutlines: [],
            
            // –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
            fps: 0,
            frameCount: 0,
            lastFpsUpdate: Date.now(),
            
            // –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã
            scanInterval: null,
            updateInterval: null,
            
            // UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            panelVisible: true,
            radarVisible: true,
            outlinesVisible: true
        };
        
        // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ===
        document.addEventListener('DOMContentLoaded', () => {
            initializeSystem();
            setupEventListeners();
            updateUIFromConfig();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
            setTimeout(() => {
                showInstruction();
            }, 1000);
        });
        
        function initializeSystem() {
            console.log('üîÑ Initializing Game Assistant Pro...');
            
            // –°–æ–∑–¥–∞–µ–º —Å–∫—Ä—ã—Ç—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
            STATE.videoElement = document.createElement('video');
            STATE.canvas = document.createElement('canvas');
            STATE.ctx = STATE.canvas.getContext('2d', { willReadFrequently: true });
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
            setupHotkeys();
            
            updateStatus('‚úÖ System ready. Press Ctrl+Shift+S to start capture');
        }
        
        function setupEventListeners() {
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ü–≤–µ—Ç–∞
            document.getElementById('colorPicker').addEventListener('input', (e) => {
                const hex = e.target.value;
                updateColorFromHex(hex);
                document.getElementById('colorPreview').style.background = hex;
            });
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            document.getElementById('sensitivity').addEventListener('input', (e) => {
                CONFIG.sensitivity = parseInt(e.target.value);
                CONFIG.scanStep = Math.max(2, 20 - Math.floor(CONFIG.sensitivity / 5));
                document.getElementById('sensValue').textContent = CONFIG.sensitivity;
            });
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–≤–æ–¥–∫–∏
            document.getElementById('outlineWidth').addEventListener('input', (e) => {
                CONFIG.outlineWidth = parseInt(e.target.value);
                document.getElementById('outlineValue').textContent = CONFIG.outlineWidth + 'px';
                updateAllOutlines();
            });
            
            // –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –ø–∞–Ω–µ–ª–∏
            makeDraggable('controlPanel');
            makeDraggable('radarContainer');
        }
        
        function updateUIFromConfig() {
            // –û–±–Ω–æ–≤–ª—è–µ–º UI –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
            document.getElementById('sensitivity').value = CONFIG.sensitivity;
            document.getElementById('sensValue').textContent = CONFIG.sensitivity;
            document.getElementById('outlineWidth').value = CONFIG.outlineWidth;
            document.getElementById('outlineValue').textContent = CONFIG.outlineWidth + 'px';
            
            const hex = rgbToHex(CONFIG.enemyColor.r, CONFIG.enemyColor.g, CONFIG.enemyColor.b);
            document.getElementById('colorPicker').value = hex;
            document.getElementById('colorPreview').style.background = hex;
        }
        
        // === –ó–ê–•–í–ê–¢ –≠–ö–†–ê–ù–ê ===
        async function startCapture() {
            if (STATE.isCapturing) {
                stopCapture();
                return;
            }
            
            updateStatus('‚è≥ Requesting screen access...');
            
            try {
                // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ —ç–∫—Ä–∞–Ω—É
                STATE.screenStream = await navigator.mediaDevices.getDisplayMedia({
                    video: {
                        displaySurface: 'window',
                        width: { ideal: 1920 },
                        height: { ideal: 1080 },
                        frameRate: { ideal: 60, max: 60 }
                    },
                    audio: false,
                    preferCurrentTab: false
                });
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –≤–∏–¥–µ–æ —ç–ª–µ–º–µ–Ω—Ç
                STATE.videoElement.srcObject = STATE.screenStream;
                STATE.videoElement.autoplay = true;
                STATE.videoElement.playsInline = true;
                
                // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
                STATE.videoElement.onloadedmetadata = () => {
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä canvas
                    STATE.canvas.width = STATE.videoElement.videoWidth;
                    STATE.canvas.height = STATE.videoElement.videoHeight;
                    
                    updateStatus(`‚úÖ Capturing: ${STATE.canvas.width}x${STATE.canvas.height}`);
                    STATE.isCapturing = true;
                    
                    // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∞–ª–∏–∑
                    startAnalysis();
                    
                    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞—Ö–≤–∞—Ç–∞
                    STATE.screenStream.getVideoTracks()[0].addEventListener('ended', () => {
                        stopCapture();
                        updateStatus('‚ùå Screen capture stopped');
                    });
                };
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–∏–¥–µ–æ
                STATE.videoElement.onerror = (e) => {
                    console.error('Video error:', e);
                    updateStatus('‚ùå Video error');
                    stopCapture();
                };
                
            } catch (error) {
                console.error('Capture error:', error);
                updateStatus(`‚ùå Error: ${error.message}`);
                
                // –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ
                if (error.name === 'NotAllowedError') {
                    showAlert(
                        'Permission Required',
                        'Please allow screen sharing when prompted.<br><br>' +
                        '1. Refresh the page<br>' +
                        '2. Click "Start Capture"<br>' +
                        '3. Select your game window<br>' +
                        '4. Click "Share"'
                    );
                }
            }
        }
        
        function stopCapture() {
            STATE.isCapturing = false;
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
            if (STATE.scanInterval) {
                clearInterval(STATE.scanInterval);
                STATE.scanInterval = null;
            }
            
            if (STATE.updateInterval) {
                clearInterval(STATE.updateInterval);
                STATE.updateInterval = null;
            }
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞—Ö–≤–∞—Ç
            if (STATE.screenStream) {
                STATE.screenStream.getTracks().forEach(track => track.stop());
                STATE.screenStream = null;
            }
            
            // –û—á–∏—â–∞–µ–º –≤—Ä–∞–≥–æ–≤
            clearEnemies();
            
            updateStatus('‚è∏Ô∏è Capture stopped');
        }
        
        // === –ê–ù–ê–õ–ò–ó –ò–ì–†–´ ===
        function startAnalysis() {
            // –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –∞–Ω–∞–ª–∏–∑–∞
            STATE.scanInterval = setInterval(() => {
                if (!STATE.isCapturing || !STATE.videoElement) return;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º FPS
                updateFPS();
                
                try {
                    // –†–∏—Å—É–µ–º —Ç–µ–∫—É—â–∏–π –∫–∞–¥—Ä –Ω–∞ canvas
                    STATE.ctx.drawImage(
                        STATE.videoElement, 
                        0, 0, 
                        STATE.canvas.width, 
                        STATE.canvas.height
                    );
                    
                    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                    const imageData = STATE.ctx.getImageData(
                        0, 0, 
                        STATE.canvas.width, 
                        STATE.canvas.height
                    );
                    
                    // –ò—â–µ–º –≤—Ä–∞–≥–æ–≤
                    scanForEnemies(imageData);
                    
                } catch (error) {
                    console.warn('Analysis error:', error);
                }
                
            }, CONFIG.updateInterval);
            
            // –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
            STATE.updateInterval = setInterval(() => {
                updateRadar();
                updateOutlines();
            }, 50); // 20 FPS –¥–ª—è UI
        }
        
        function scanForEnemies(imageData) {
            const data = imageData.data;
            const width = imageData.width;
            const height = imageData.height;
            
            const targetColor = CONFIG.enemyColor;
            const threshold = CONFIG.colorThreshold;
            const step = CONFIG.scanStep;
            
            const enemyPixels = [];
            
            // –ë—ã—Å—Ç—Ä–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —à–∞–≥–æ–º
            for (let y = 0; y < height; y += step) {
                for (let x = 0; x < width; x += step) {
                    const index = (y * width + x) * 4;
                    
                    const r = data[index];
                    const g = data[index + 1];
                    const b = data[index + 2];
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Ü–≤–µ—Ç
                    const colorDiff = 
                        Math.abs(r - targetColor.r) + 
                        Math.abs(g - targetColor.g) + 
                        Math.abs(b - targetColor.b);
                    
                    if (colorDiff < threshold) {
                        enemyPixels.push({ x, y, r, g, b });
                    }
                }
            }
            
            // –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –ø–∏–∫—Å–µ–ª–µ–π –≤–æ –≤—Ä–∞–≥–æ–≤
            if (enemyPixels.length > 0) {
                STATE.enemies = clusterEnemies(enemyPixels);
                
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ä–∞–≥–æ–≤
                if (STATE.enemies.length > CONFIG.maxEnemies) {
                    STATE.enemies = STATE.enemies.slice(0, CONFIG.maxEnemies);
                }
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è
                if (STATE.enemies.length > 0 && STATE.frameCount % 10 === 0) {
                    flashDetection();
                }
            } else {
                STATE.enemies = [];
            }
        }
        
        function clusterEnemies(pixels) {
            const clusters = [];
            const clusterDistance = 80; // –ú–∞–∫—Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –≤ –∫–ª–∞—Å—Ç–µ—Ä
            
            for (const pixel of pixels) {
                let addedToCluster = false;
                
                for (const cluster of clusters) {
                    const dist = Math.sqrt(
                        Math.pow(pixel.x - cluster.center.x, 2) + 
                        Math.pow(pixel.y - cluster.center.y, 2)
                    );
                    
                    if (dist < clusterDistance) {
                        cluster.pixels.push(pixel);
                        
                        // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º —Ü–µ–Ω—Ç—Ä
                        cluster.center.x = cluster.pixels.reduce((sum, p) => sum + p.x, 0) / cluster.pixels.length;
                        cluster.center.y = cluster.pixels.reduce((sum, p) => sum + p.y, 0) / cluster.pixels.length;
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ä–µ–¥–Ω–∏–π —Ü–≤–µ—Ç
                        cluster.color.r = cluster.pixels.reduce((sum, p) => sum + p.r, 0) / cluster.pixels.length;
                        cluster.color.g = cluster.pixels.reduce((sum, p) => sum + p.g, 0) / cluster.pixels.length;
                        cluster.color.b = cluster.pixels.reduce((sum, p) => sum + p.b, 0) / cluster.pixels.length;
                        
                        addedToCluster = true;
                        break;
                    }
                }
                
                if (!addedToCluster) {
                    clusters.push({
                        pixels: [pixel],
                        center: { x: pixel.x, y: pixel.y },
                        color: { r: pixel.r, g: pixel.g, b: pixel.b },
                        size: 1
                    });
                }
            }
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –º–∞–ª–µ–Ω—å–∫–∏–µ –∫–ª–∞—Å—Ç–µ—Ä—ã (—à—É–º)
            return clusters.filter(cluster => 
                cluster.pixels.length > (CONFIG.sensitivity / 10)
            ).map(cluster => ({
                x: Math.round(cluster.center.x),
                y: Math.round(cluster.center.y),
                width: Math.max(20, Math.sqrt(cluster.pixels.length) * 5),
                height: Math.max(20, Math.sqrt(cluster.pixels.length) * 5),
                color: cluster.color,
                distance: calculateDistance(cluster.center.x, cluster.center.y)
            }));
        }
        
        function calculateDistance(x, y) {
            // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ —ç–∫—Ä–∞–Ω–∞
            const centerX = STATE.canvas.width / 2;
            const centerY = STATE.canvas.height / 2;
            
            const dist = Math.sqrt(
                Math.pow(x - centerX, 2) + 
                Math.pow(y - centerY, 2)
            );
            
            // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∫ 0-100
            const maxDist = Math.sqrt(
                Math.pow(STATE.canvas.width, 2) + 
                Math.pow(STATE.canvas.height, 2)
            ) / 2;
            
            return Math.round((dist / maxDist) * 100);
        }
        
        // === –û–ë–í–û–î–ö–ê –í–†–ê–ì–û–í ===
        function updateOutlines() {
            if (!CONFIG.outlineEnabled || !STATE.outlinesVisible) {
                clearOutlines();
                return;
            }
            
            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –æ–±–≤–æ–¥–∫–∏
            clearOutlines();
            
            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ –æ–±–≤–æ–¥–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—Ä–∞–≥–∞
            STATE.enemies.forEach((enemy, index) => {
                createEnemyOutline(enemy, index);
            });
        }
        
        function createEnemyOutline(enemy, id) {
            const outline = document.createElement('div');
            outline.className = `enemyOutline outline-${CONFIG.outlineColor}`;
            outline.id = `enemyOutline_${id}`;
            
            // –ü–æ–∑–∏—Ü–∏—è –∏ —Ä–∞–∑–º–µ—Ä
            const padding = 5; // –ù–µ–±–æ–ª—å—à–æ–π –æ—Ç—Å—Ç—É–ø
            outline.style.left = `${enemy.x - enemy.width/2 - padding}px`;
            outline.style.top = `${enemy.y - enemy.height/2 - padding}px`;
            outline.style.width = `${enemy.width + padding*2}px`;
            outline.style.height = `${enemy.height + padding*2}px`;
            
            // –°–æ–∑–¥–∞–µ–º —Ä–∞–º–∫—É
            const box = document.createElement('div');
            box.className = `outline-box outline-${CONFIG.outlineColor}`;
            box.style.borderWidth = `${CONFIG.outlineWidth}px`;
            box.style.borderColor = CONFIG.outlineColors[CONFIG.outlineColor];
            box.style.width = '100%';
            box.style.height = '100%';
            
            // –ú–µ—Ç–∫–∞ —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º
            if (CONFIG.showDistance) {
                const label = document.createElement('div');
                label.className = 'enemyLabel label-red';
                label.textContent = `ENEMY ${enemy.distance}m`;
                label.style.top = `${-25}px`;
                label.style.left = '50%';
                outline.appendChild(label);
                
                // –î–∏—Å—Ç–∞–Ω—Ü–∏—è –ø–æ–¥ –æ–±–≤–æ–¥–∫–æ–π
                const distance = document.createElement('div');
                distance.className = 'label-distance';
                distance.textContent = `${enemy.distance}m`;
                distance.style.top = `${enemy.height + padding*2 + 5}px`;
                distance.style.left = '50%';
                outline.appendChild(distance);
            }
            
            outline.appendChild(box);
            document.getElementById('gameOverlay').appendChild(outline);
            STATE.enemyOutlines.push(outline);
        }
        
        function clearOutlines() {
            STATE.enemyOutlines.forEach(outline => {
                if (outline && outline.parentNode) {
                    outline.parentNode.removeChild(outline);
                }
            });
            STATE.enemyOutlines = [];
        }
        
        function updateAllOutlines() {
            clearOutlines();
            updateOutlines();
        }
        
        // === –†–ê–î–ê–† ===
        function updateRadar() {
            if (!CONFIG.radarEnabled || !STATE.radarVisible) {
                clearRadar();
                return;
            }
            
            // –û—á–∏—â–∞–µ–º —Ä–∞–¥–∞—Ä
            clearRadar();
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤—Ä–∞–≥–æ–≤ –Ω–∞ —Ä–∞–¥–∞—Ä
            STATE.enemies.forEach((enemy, index) => {
                addEnemyToRadar(enemy, index);
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
            const status = document.getElementById('statusBar');
            if (STATE.enemies.length > 0) {
                status.innerHTML = `üéØ ${STATE.enemies.length} enemies detected | FPS: ${STATE.fps}`;
                status.style.background = 'rgba(255, 50, 50, 0.8)';
            } else {
                status.innerHTML = `‚úÖ No enemies | FPS: ${STATE.fps}`;
                status.style.background = 'rgba(0, 0, 0, 0.8)';
            }
        }
        
        function addEnemyToRadar(enemy, index) {
            const radar = document.getElementById('radar');
            
            // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —ç–∫—Ä–∞–Ω–∞ –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ä–∞–¥–∞—Ä–∞
            const radarX = (enemy.x / STATE.canvas.width) * 100;
            const radarY = (enemy.y / STATE.canvas.height) * 100;
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ä–∞–¥–∞—Ä–∞
            const boundedX = Math.max(5, Math.min(95, radarX));
            const boundedY = Math.max(5, Math.min(95, radarY));
            
            // –¢–æ—á–∫–∞ –≤—Ä–∞–≥–∞
            const enemyDot = document.createElement('div');
            enemyDot.className = 'radarEnemy';
            enemyDot.style.left = `${boundedX}%`;
            enemyDot.style.top = `${boundedY}%`;
            enemyDot.style.animationDelay = `${index * 0.1}s`;
            
            // –õ–∏–Ω–∏—è –∫ –≤—Ä–∞–≥—É –æ—Ç —Ü–µ–Ω—Ç—Ä–∞
            const line = document.createElement('div');
            line.className = 'radarLine';
            line.style.left = '50%';
            line.style.top = '50%';
            
            const dx = boundedX - 50;
            const dy = boundedY - 50;
            const length = Math.sqrt(dx * dx + dy * dy);
            const angle = Math.atan2(dy, dx) * (180 / Math.PI);
            
            line.style.width = `${length}%`;
            line.style.transform = `rotate(${angle}deg)`;
            
            // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Ä–∞–≥–µ
            const info = document.createElement('div');
            info.className = 'enemyInfo';
            info.textContent = `${enemy.distance}m`;
            info.style.left = `${boundedX}%`;
            info.style.top = `${boundedY - 15}%`;
            
            radar.appendChild(line);
            radar.appendChild(enemyDot);
            radar.appendChild(info);
        }
        
        function clearRadar() {
            const radar = document.getElementById('radar');
            const elements = radar.querySelectorAll('.radarLine, .radarEnemy, .enemyInfo');
            elements.forEach(el => el.remove());
        }
        
        function clearEnemies() {
            STATE.enemies = [];
            clearRadar();
            clearOutlines();
        }
        
        // === –ö–ê–õ–ò–ë–†–û–í–ö–ê –¶–í–ï–¢–ê ===
        function calibrateColor() {
            if (!STATE.isCapturing) {
                showAlert('Error', 'Start screen capture first!');
                return;
            }
            
            updateStatus('üé® Calibration - Click on an enemy');
            
            // –°–æ–∑–¥–∞–µ–º –æ–∫–Ω–æ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
            const calibrator = document.createElement('div');
            calibrator.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 600px;
                height: 400px;
                background: rgba(0, 0, 0, 0.95);
                border: 3px solid #00ff9d;
                z-index: 2147483647;
                cursor: crosshair;
                border-radius: 10px;
                overflow: hidden;
            `;
            
            const canvas = document.createElement('canvas');
            canvas.width = 600;
            canvas.height = 400;
            calibrator.appendChild(canvas);
            
            const ctx = canvas.getContext('2d');
            ctx.drawImage(STATE.videoElement, 0, 0, 600, 400);
            
            // –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
            const instruction = document.createElement('div');
            instruction.style.cssText = `
                position: absolute;
                bottom: 10px;
                left: 0;
                width: 100%;
                text-align: center;
                color: #00ff9d;
                font-size: 14px;
                background: rgba(0, 0, 0, 0.7);
                padding: 10px;
            `;
            instruction.textContent = 'Click on an enemy to capture its color';
            calibrator.appendChild(instruction);
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞
            canvas.addEventListener('click', (e) => {
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                const pixel = ctx.getImageData(x, y, 1, 1).data;
                const hex = rgbToHex(pixel[0], pixel[1], pixel[2]);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–≤–µ—Ç
                updateColorFromRGB(pixel[0], pixel[1], pixel[2]);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ü–≤–µ—Ç
                ctx.strokeStyle = '#00ff9d';
                ctx.lineWidth = 3;
                ctx.strokeRect(x - 10, y - 10, 20, 20);
                
                // –¶–≤–µ—Ç–æ–≤–æ–π –∫—Ä—É–≥
                ctx.beginPath();
                ctx.arc(x, y, 15, 0, Math.PI * 2);
                ctx.strokeStyle = hex;
                ctx.lineWidth = 5;
                ctx.stroke();
                
                updateStatus(`‚úÖ Color set to RGB(${pixel[0]}, ${pixel[1]}, ${pixel[2]})`);
                
                setTimeout(() => {
                    calibrator.remove();
                    updateStatus('‚úÖ Calibration complete');
                }, 1500);
            });
            
            // –ö–Ω–æ–ø–∫–∞ –æ—Ç–º–µ–Ω—ã
            const cancelBtn = document.createElement('button');
            cancelBtn.textContent = 'Cancel';
            cancelBtn.style.cssText = `
                position: absolute;
                top: 10px;
                right: 10px;
                padding: 5px 15px;
                background: #ff3333;
                color: white;
                border: none;
                border-radius: 5px;
                cursor: pointer;
            `;
            cancelBtn.onclick = () => {
                calibrator.remove();
                updateStatus('Calibration cancelled');
            };
            calibrator.appendChild(cancelBtn);
            
            document.body.appendChild(calibrator);
        }
        
        // === –£–ü–†–ê–í–õ–ï–ù–ò–ï UI ===
        function togglePanel() {
            STATE.panelVisible = !STATE.panelVisible;
            document.getElementById('controlPanel').classList.toggle('hidden');
        }
        
        function toggleRadar() {
            STATE.radarVisible = !STATE.radarVisible;
            document.getElementById('radarContainer').classList.toggle('hidden');
            updateStatus(STATE.radarVisible ? 'üì° Radar enabled' : 'üì° Radar disabled');
        }
        
        function toggleOutlines() {
            STATE.outlinesVisible = !STATE.outlinesVisible;
            if (!STATE.outlinesVisible) {
                clearOutlines();
            }
            updateStatus(STATE.outlinesVisible ? 'üî≤ Outlines enabled' : 'üî≤ Outlines disabled');
        }
        
        function setOutlineColor(color) {
            CONFIG.outlineColor = color;
            updateAllOutlines();
            updateStatus(`üåà Outline color set to ${color}`);
        }
        
        function resetAll() {
            if (confirm('Reset all settings to default?')) {
                CONFIG.enemyColor = { r: 255, g: 0, b: 0 };
                CONFIG.sensitivity = 50;
                CONFIG.outlineWidth = 3;
                CONFIG.outlineColor = 'red';
                
                updateUIFromConfig();
                updateAllOutlines();
                updateStatus('üîÑ All settings reset to default');
            }
        }
        
        // === –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ===
        function updateColorFromHex(hex) {
            const r = parseInt(hex.substr(1,2), 16);
            const g = parseInt(hex.substr(3,2), 16);
            const b = parseInt(hex.substr(5,2), 16);
            
            CONFIG.enemyColor = { r, g, b };
        }
        
        function updateColorFromRGB(r, g, b) {
            CONFIG.enemyColor = { r, g, b };
            
            const hex = rgbToHex(r, g, b);
            document.getElementById('colorPicker').value = hex;
            document.getElementById('colorPreview').style.background = hex;
        }
        
        function rgbToHex(r, g, b) {
            return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
        }
        
        function updateFPS() {
            STATE.frameCount++;
            const now = Date.now();
            
            if (now - STATE.lastFpsUpdate >= 1000) {
                STATE.fps = STATE.frameCount;
                STATE.frameCount = 0;
                STATE.lastFpsUpdate = now;
            }
        }
        
        function updateStatus(message) {
            const status = document.getElementById('statusBar');
            status.innerHTML = message;
        }
        
        function flashDetection() {
            const flash = document.createElement('div');
            flash.className = 'detection-flash';
            document.getElementById('gameOverlay').appendChild(flash);
            
            setTimeout(() => {
                if (flash.parentNode) {
                    flash.parentNode.removeChild(flash);
                }
            }, 500);
        }
        
        function makeDraggable(elementId) {
            const element = document.getElementById(elementId);
            let isDragging = false;
            let offsetX, offsetY;
            
            element.addEventListener('mousedown', startDrag);
            
            function startDrag(e) {
                isDragging = true;
                offsetX = e.clientX - element.getBoundingClientRect().left;
                offsetY = e.clientY - element.getBoundingClientRect().top;
                
                document.addEventListener('mousemove', drag);
                document.addEventListener('mouseup', stopDrag);
                
                e.preventDefault();
            }
            
            function drag(e) {
                if (!isDragging) return;
                
                element.style.left = (e.clientX - offsetX) + 'px';
                element.style.top = (e.clientY - offsetY) + 'px';
                element.style.right = 'auto';
                element.style.bottom = 'auto';
            }
            
            function stopDrag() {
                isDragging = false;
                document.removeEventListener('mousemove', drag);
                document.removeEventListener('mouseup', stopDrag);
            }
        }
        
        function setupHotkeys() {
            document.addEventListener('keydown', (e) => {
                // Ctrl+Shift+S - Start/Stop capture
                if (e.ctrlKey && e.shiftKey && e.key === 'S') {
                    e.preventDefault();
                    startCapture();
                }
                
                // Ctrl+Shift+R - Toggle radar
                if (e.ctrlKey && e.shiftKey && e.key === 'R') {
                    e.preventDefault();
                    toggleRadar();
                }
                
                // Ctrl+Shift+O - Toggle outlines
                if (e.ctrlKey && e.shiftKey && e.key === 'O') {
                    e.preventDefault();
                    toggleOutlines();
                }
                
                // Ctrl+Shift+H - Hide/show panel
                if (e.ctrlKey && e.shiftKey && e.key === 'H') {
                    e.preventDefault();
                    togglePanel();
                }
                
                // Ctrl+Shift+C - Calibrate
                if (e.ctrlKey && e.shiftKey && e.key === 'C') {
                    e.preventDefault();
                    calibrateColor();
                }
            });
        }
        
        function showAlert(title, message) {
            const alert = document.createElement('div');
            alert.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(10, 15, 30, 0.95);
                color: #00ff9d;
                padding: 20px;
                border-radius: 10px;
                border: 2px solid #00a8ff;
                z-index: 2147483647;
                min-width: 300px;
                text-align: center;
            `;
            
            alert.innerHTML = `
                <h3 style="margin-bottom: 10px;">${title}</h3>
                <div style="margin-bottom: 15px;">${message}</div>
                <button onclick="this.parentElement.remove()" 
                        style="padding: 8px 20px; background: #00a8ff; color: white; border: none; border-radius: 5px; cursor: pointer;">
                    OK
                </button>
            `;
            
            document.body.appendChild(alert);
        }
        
        function showInstruction() {
            showAlert(
                'üéÆ Game Assistant Pro - Instructions',
                `
                <div style="text-align: left; font-size: 12px; line-height: 1.5;">
                    <strong>QUICK START:</strong><br>
                    1. Set game to <strong>Windowed/Borderless</strong><br>
                    2. Press <strong>Ctrl+Shift+S</strong> to start<br>
                    3. Select game window when prompted<br>
                    4. Click <strong>Calibrate</strong> and click on enemy<br>
                    5. Adjust settings as needed<br><br>
                    
                    <strong>HOTKEYS:</strong><br>
                    ‚Ä¢ Ctrl+Shift+S = Start/Stop capture<br>
                    ‚Ä¢ Ctrl+Shift+R = Toggle radar<br>
                    ‚Ä¢ Ctrl+Shift+O = Toggle outlines<br>
                    ‚Ä¢ Ctrl+Shift+H = Hide/show panel<br>
                    ‚Ä¢ Ctrl+Shift+C = Calibrate color<br><br>
                    
                    <strong>TIPS:</strong><br>
                    ‚Ä¢ Drag panels to reposition<br>
                    ‚Ä¢ Adjust sensitivity for performance<br>
                    ‚Ä¢ Use calibrate for best accuracy<br>
                    ‚Ä¢ Toggle elements to reduce clutter
                </div>
                `
            );
        }
        
        // === –û–ß–ò–°–¢–ö–ê –ü–†–ò –ó–ê–ö–†–´–¢–ò–ò ===
        window.addEventListener('beforeunload', () => {
            stopCapture();
            clearEnemies();
        });
        
        console.log('üéÆ Game Assistant Pro loaded successfully!');
    </script>
</body>
</html>